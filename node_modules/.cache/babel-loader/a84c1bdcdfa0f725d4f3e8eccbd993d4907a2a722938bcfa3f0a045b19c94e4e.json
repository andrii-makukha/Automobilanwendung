{"ast":null,"code":"import React from 'react';\nimport { TranslationParserError } from './TranslationParserError.js';\nimport { tokenize } from './tokenizer.js';\nimport { decodeHtmlEntities } from './htmlEntityDecoder.js';\nconst renderDeclarationNode = (declaration, children, childDeclarations) => {\n  const {\n    type,\n    props = {}\n  } = declaration;\n  if (props.children && Array.isArray(props.children) && childDeclarations) {\n    const {\n      children: _childrenToRemove,\n      ...propsWithoutChildren\n    } = props;\n    return React.createElement(type, propsWithoutChildren, ...children);\n  }\n  if (children.length === 0) {\n    return React.createElement(type, props);\n  }\n  if (children.length === 1) {\n    return React.createElement(type, props, children[0]);\n  }\n  return React.createElement(type, props, ...children);\n};\nexport const renderTranslation = function (translation) {\n  let declarations = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  if (!translation) {\n    return [];\n  }\n  const tokens = tokenize(translation);\n  const result = [];\n  const stack = [];\n  const literalTagNumbers = new Set();\n  const getCurrentDeclarations = () => {\n    if (stack.length === 0) {\n      return declarations;\n    }\n    const parentFrame = stack[stack.length - 1];\n    if (parentFrame.declaration.props?.children && Array.isArray(parentFrame.declaration.props.children)) {\n      return parentFrame.declaration.props.children;\n    }\n    return parentFrame.declarations;\n  };\n  tokens.forEach(token => {\n    switch (token.type) {\n      case 'Text':\n        {\n          const decoded = decodeHtmlEntities(token.value);\n          const targetArray = stack.length > 0 ? stack[stack.length - 1].children : result;\n          targetArray.push(decoded);\n        }\n        break;\n      case 'TagOpen':\n        {\n          const {\n            tagNumber\n          } = token;\n          const currentDeclarations = getCurrentDeclarations();\n          const declaration = currentDeclarations[tagNumber];\n          if (!declaration) {\n            literalTagNumbers.add(tagNumber);\n            const literalText = `<${tagNumber}>`;\n            const targetArray = stack.length > 0 ? stack[stack.length - 1].children : result;\n            targetArray.push(literalText);\n            break;\n          }\n          stack.push({\n            tagNumber,\n            children: [],\n            position: token.position,\n            declaration,\n            declarations: currentDeclarations\n          });\n        }\n        break;\n      case 'TagClose':\n        {\n          const {\n            tagNumber\n          } = token;\n          if (literalTagNumbers.has(tagNumber)) {\n            const literalText = `</${tagNumber}>`;\n            const literalTargetArray = stack.length > 0 ? stack[stack.length - 1].children : result;\n            literalTargetArray.push(literalText);\n            literalTagNumbers.delete(tagNumber);\n            break;\n          }\n          if (stack.length === 0) {\n            throw new TranslationParserError(`Unexpected closing tag </${tagNumber}> at position ${token.position}`, token.position, translation);\n          }\n          const frame = stack.pop();\n          if (frame.tagNumber !== tagNumber) {\n            throw new TranslationParserError(`Mismatched tags: expected </${frame.tagNumber}> but got </${tagNumber}> at position ${token.position}`, token.position, translation);\n          }\n          const element = renderDeclarationNode(frame.declaration, frame.children, frame.declarations);\n          const elementTargetArray = stack.length > 0 ? stack[stack.length - 1].children : result;\n          elementTargetArray.push(element);\n        }\n        break;\n    }\n  });\n  if (stack.length > 0) {\n    const unclosed = stack[stack.length - 1];\n    throw new TranslationParserError(`Unclosed tag <${unclosed.tagNumber}> at position ${unclosed.position}`, unclosed.position, translation);\n  }\n  return result;\n};","map":{"version":3,"names":["React","TranslationParserError","tokenize","decodeHtmlEntities","renderDeclarationNode","declaration","children","childDeclarations","type","props","Array","isArray","_childrenToRemove","propsWithoutChildren","createElement","length","renderTranslation","translation","declarations","arguments","undefined","tokens","result","stack","literalTagNumbers","Set","getCurrentDeclarations","parentFrame","forEach","token","decoded","value","targetArray","push","tagNumber","currentDeclarations","add","literalText","position","has","literalTargetArray","delete","frame","pop","element","elementTargetArray","unclosed"],"sources":["/Users/andriimakukha/Hillel/lesson-46/node_modules/react-i18next/dist/es/IcuTransUtils/renderTranslation.js"],"sourcesContent":["import React from 'react';\nimport { TranslationParserError } from './TranslationParserError.js';\nimport { tokenize } from './tokenizer.js';\nimport { decodeHtmlEntities } from './htmlEntityDecoder.js';\nconst renderDeclarationNode = (declaration, children, childDeclarations) => {\n  const {\n    type,\n    props = {}\n  } = declaration;\n  if (props.children && Array.isArray(props.children) && childDeclarations) {\n    const {\n      children: _childrenToRemove,\n      ...propsWithoutChildren\n    } = props;\n    return React.createElement(type, propsWithoutChildren, ...children);\n  }\n  if (children.length === 0) {\n    return React.createElement(type, props);\n  }\n  if (children.length === 1) {\n    return React.createElement(type, props, children[0]);\n  }\n  return React.createElement(type, props, ...children);\n};\nexport const renderTranslation = (translation, declarations = []) => {\n  if (!translation) {\n    return [];\n  }\n  const tokens = tokenize(translation);\n  const result = [];\n  const stack = [];\n  const literalTagNumbers = new Set();\n  const getCurrentDeclarations = () => {\n    if (stack.length === 0) {\n      return declarations;\n    }\n    const parentFrame = stack[stack.length - 1];\n    if (parentFrame.declaration.props?.children && Array.isArray(parentFrame.declaration.props.children)) {\n      return parentFrame.declaration.props.children;\n    }\n    return parentFrame.declarations;\n  };\n  tokens.forEach(token => {\n    switch (token.type) {\n      case 'Text':\n        {\n          const decoded = decodeHtmlEntities(token.value);\n          const targetArray = stack.length > 0 ? stack[stack.length - 1].children : result;\n          targetArray.push(decoded);\n        }\n        break;\n      case 'TagOpen':\n        {\n          const {\n            tagNumber\n          } = token;\n          const currentDeclarations = getCurrentDeclarations();\n          const declaration = currentDeclarations[tagNumber];\n          if (!declaration) {\n            literalTagNumbers.add(tagNumber);\n            const literalText = `<${tagNumber}>`;\n            const targetArray = stack.length > 0 ? stack[stack.length - 1].children : result;\n            targetArray.push(literalText);\n            break;\n          }\n          stack.push({\n            tagNumber,\n            children: [],\n            position: token.position,\n            declaration,\n            declarations: currentDeclarations\n          });\n        }\n        break;\n      case 'TagClose':\n        {\n          const {\n            tagNumber\n          } = token;\n          if (literalTagNumbers.has(tagNumber)) {\n            const literalText = `</${tagNumber}>`;\n            const literalTargetArray = stack.length > 0 ? stack[stack.length - 1].children : result;\n            literalTargetArray.push(literalText);\n            literalTagNumbers.delete(tagNumber);\n            break;\n          }\n          if (stack.length === 0) {\n            throw new TranslationParserError(`Unexpected closing tag </${tagNumber}> at position ${token.position}`, token.position, translation);\n          }\n          const frame = stack.pop();\n          if (frame.tagNumber !== tagNumber) {\n            throw new TranslationParserError(`Mismatched tags: expected </${frame.tagNumber}> but got </${tagNumber}> at position ${token.position}`, token.position, translation);\n          }\n          const element = renderDeclarationNode(frame.declaration, frame.children, frame.declarations);\n          const elementTargetArray = stack.length > 0 ? stack[stack.length - 1].children : result;\n          elementTargetArray.push(element);\n        }\n        break;\n    }\n  });\n  if (stack.length > 0) {\n    const unclosed = stack[stack.length - 1];\n    throw new TranslationParserError(`Unclosed tag <${unclosed.tagNumber}> at position ${unclosed.position}`, unclosed.position, translation);\n  }\n  return result;\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}